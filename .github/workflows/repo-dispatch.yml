name: Repository dispatch

on:
  push:
  workflow_dispatch:

jobs:
  run-tests:
    name: "Trigger e2e tests in other repo"
    runs-on: ubuntu-latest
    if: github.repository == 'adimoldovan/sandbox'

    steps:
      - name: Create a repository dispatch
        uses: peter-evans/repository-dispatch@v2
        with:
          token: ${{ secrets.REPO_DISPATCH_TOKEN }}
          repository: adimoldovan/demo-ui-tests-playwright-jest
          event-type: e2e tests $GITHUB_EVENT_NAME $GITHUB_REPOSITORY $GITHUB_REF_NAME $GITHUB_REF_TYPE
          client-payload: '{
          "repository": "$GITHUB_REPOSITORY",
          "ref_name": "$GITHUB_REF_NAME",
          "ref_type": "$GITHUB_REF_TYPE"
          }}'
